<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="kr.or.bus.dao.CommuteDAO">

	<!-- 회원의 출/퇴근 정보 조회 -->
 	<select id="getSelect" resultType="kr.or.bus.dto.CommuteJoinCstartJoinCendDTO" parameterType="String">
		select * from 
			(select rownum, N.*
			 from (
			 		select c_date, c_start, c_end 
			 		from commute
			 		where m_id= #{param3} order by c_date desc
			 	   )N
			 )where rownum between 1 + (#{param1}-1) * 5 and 5 + (#{param1}-1)*10
	</select>
	
	<update id="csupdate">
	update commute 
	<set>
		<choose>
			<when test="c_time='am' and c_start &gt; '0900'">
			cs_code='2'
			</when>		
			<when test="c_time='am' and c_start &lt; '0900'">
			cs_code='1'
			</when>
			<when test="c_time='pm' and c_start &lt; '0900'">
			cs_code='1'
			</when>
			<when test="c_time='pm' and c_start &gt; '0900'">
			cs_code='2'
			</when>
		</choose>
	</set>	
	where m_id=#{m_id}
	</update>
 	
	<select id="csselect"  resultType = "kr.or.bus.dto.CommuteJoinCstartJoinCendDTO">
		select c_start, cs_stat
		from commute com join cstart cs on com.cs_code=cs.cs_code
		where m_id=#{m_id}
	</select>
</mapper>


